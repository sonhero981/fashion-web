{"ast":null,"code":"import axioisClient from \"./axios\";\nimport axios from \"axios\";\nimport { Cloudinary } from \"@cloudinary/url-gen\";\nimport Swal from \"sweetalert2/dist/sweetalert2.js\";\nimport \"sweetalert2/src/sweetalert2.scss\"; // Xử lý chuyển qua lại giữa login và register\n\nfunction handleClick(isLoginPage, callback) {\n  callback(!isLoginPage);\n} //Xử lý gửi form đăng nhập\n\n\nfunction handleLogin(username, password) {\n  let role = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"USER_ROLE\";\n  let redirect = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : \"/\";\n\n  if (!Boolean(username) || !Boolean(password)) {\n    Swal.fire({\n      icon: \"error\",\n      text: \"Vui lòng nhập đầy đủ thông tin....\",\n      timer: 1200\n    });\n  } else {\n    axioisClient.post(\"login\", {\n      username,\n      password,\n      role\n    }).then(res => {\n      if (res.err) {\n        Swal.fire({\n          icon: \"error\",\n          text: res.mess,\n          timer: 1200\n        });\n      } else {\n        Swal.fire({\n          icon: \"success\",\n          text: \"Đăng nhập thành công...\",\n          timer: 1200\n        });\n        localStorage.setItem(\"isLogin\", res.account._id);\n        localStorage.setItem(\"roleLogin\", res.account.role);\n        setTimeout(() => {\n          window.location.assign(`${redirect}`);\n        }, 1200);\n      }\n\n      console.log(res);\n    }).catch(() => {\n      Swal.fire({\n        icon: \"error\",\n        text: \"Chưa thể xử lý....\",\n        timer: 1200\n      });\n    });\n  }\n} //Xử lý gửi form đăng ký\n\n\nfunction handleRegsiter(username, password, confirmPassword, email, phone, address) {\n  if (username === \"\" || password === \"\" || confirmPassword === \"\" || email === \"\" || phone === \"\" || address === \"\") {\n    Swal.fire({\n      icon: \"error\",\n      text: \"Vui lòng nhập đầy đủ thông tin....\",\n      timer: 1000\n    });\n  } else if (password !== confirmPassword) {\n    Swal.fire({\n      icon: \"error\",\n      text: \"Xác thực mật khẩu không đúng...\",\n      timer: 1000\n    });\n  } else {\n    axioisClient.post(\"register\", {\n      username,\n      password,\n      email,\n      phone,\n      address\n    }).then(res => {\n      if (res.err) {\n        Swal.fire({\n          icon: \"error\",\n          text: \"Tài khoản đã tồn tại...\",\n          timer: 1000\n        });\n      } else {\n        const time = 1200;\n        Swal.fire({\n          icon: \"success\",\n          text: \"Đăng ký thành công...\",\n          timer: time\n        });\n        setTimeout(() => {\n          window.location.assign(\"http://localhost:3000/\");\n        }, time);\n      }\n    }).catch(() => {\n      Swal.fire({\n        icon: \"error\",\n        text: \"Dữ liệu tại chưa được xử lý...\",\n        timer: 1000\n      });\n    });\n  }\n} //xử lý thêm vào giỏ hàng\n\n\nfunction handle_add_to_cart(user_id, product_id, one_pr_price, amount) {\n  if (!Boolean(localStorage.getItem(\"isLogin\"))) {\n    Swal.fire({\n      icon: \"error\",\n      text: \"Vui lòng đăng nhập để tiếp tục....\",\n      timer: 1000\n    });\n  } else {\n    axioisClient.post(\"add-to-cart\", {\n      user_id,\n      product_id,\n      one_pr_price,\n      amount\n    }).then(res => {\n      if (!res.err) {\n        const status = res.status;\n        const cart_id = document.querySelector(\".cart_id\");\n\n        if (status === 0) {\n          cart_id.innerHTML = +cart_id.textContent + 1;\n        }\n\n        Swal.fire({\n          icon: \"success\",\n          text: \"Thêm thàng công....\",\n          timer: 1000\n        });\n      } else {}\n\n      console.log(res);\n    });\n  }\n} // lấy ra số lượng đơn hàng trong giỏ hàng\n\n\nfunction handle_get_size_cart(user_id) {\n  axioisClient.get(`user/carts/${user_id}`).then(res => {\n    const cart_id = document.querySelector(\".cart_id\");\n    cart_id.innerHTML = res.size;\n  }).catch(error => {\n    console.log(\"Co loix\");\n  });\n} // xử lý xóa đơn hàng khỏi giỏ hàng\n\n\nfunction handleDeleteProductFormCart(_id) {\n  axioisClient.post(\"/cart/detete\", {\n    _id\n  }).then(res => {\n    console.log(res);\n  }).catch(err => {\n    console.log(err);\n  });\n} // xử lý thêm sản phẩm ở trang Admin\n\n\nasync function addProductByAdmin(obj) {\n  if (!Boolean(obj.name) || !Boolean(obj.price) || !Boolean(obj.amount) || !Boolean(obj.origin) || !Boolean(obj.classify) || !Boolean(obj.desc) || !Boolean(obj.image)) {\n    Swal.fire({\n      icon: \"error\",\n      text: \"Vui lòng nhập đủ thông tin sản phẩm\",\n      timer: 1100\n    });\n  } else if (!Boolean(+obj.price.replaceAll(\".\", \"\")) || obj.price.charAt(obj.price.length - 4) != \".\") {\n    Swal.fire({\n      icon: \"error\",\n      text: \"Giá tiền không hợp lệ\",\n      timer: 1100\n    });\n  } else {\n    console.log(obj);\n    const data = await handleUploadCloudinary(obj.image);\n    axioisClient.post(\"/add-product\", { ...obj,\n      image: data.url\n    }).then(res => {\n      if (res.err) {\n        Swal.fire({\n          icon: \"error\",\n          text: \"Sản phẩm đã tồn tại...\",\n          timer: 1100\n        });\n      } else {\n        Swal.fire({\n          icon: \"success\",\n          text: \"Thêm thành công...\",\n          timer: 1100\n        });\n      }\n    }).catch(err => {\n      Swal.fire({\n        icon: \"error\",\n        text: \"Có lỗi trong quá trình xử lý...\",\n        timer: 1100\n      });\n    });\n  }\n}\n\nfunction handleFile(file) {} // xử lý thanh toán\n\n\nfunction handlePayment(listIdCart) {\n  axioisClient.post(\"/user/payment\", {\n    cart_list: JSON.stringify(listIdCart)\n  }).then(res => {\n    if (res.err) {\n      Swal.fire({\n        icon: \"error\",\n        text: \"Thanh toán không thành công.... \",\n        timer: 1100\n      });\n    } else {\n      Swal.fire({\n        icon: \"success\",\n        text: \"Thanh toán thành công....\",\n        timer: 1100\n      });\n      setTimeout(() => {\n        window.location.replace(window.location.href);\n      }, 1100);\n    }\n  }).catch(err => {\n    console.log(err);\n  });\n} // kiểm tra đăng nhập\n\n\nfunction checkLogin() {\n  const isLogin = localStorage.getItem(\"isLogin\");\n  return Boolean(isLogin);\n} // xử lý đăng xuất\n\n\nfunction handleLogout(redirect) {\n  localStorage.removeItem(\"isLogin\");\n  localStorage.removeItem(\"roleLogin\");\n  Swal.fire({\n    icon: \"success\",\n    text: \"Đăng xuất thành công...\",\n    timer: 1000\n  });\n  setTimeout(() => {\n    window.location.assign(`http://localhost:3000/${redirect}`);\n  }, 1000);\n} // xử lý xóa sản phẩm trang admin\n\n\nfunction handleDeleteProduct(_id) {\n  try {\n    axioisClient.post(\"/admin/delete-product\", {\n      _id\n    }).then(res => {\n      const icon = res.err ? \"error\" : \"success\";\n      Swal.fire({\n        icon: `${icon}`,\n        text: `${res.mess}`,\n        timer: 1100\n      });\n      setTimeout(() => {\n        window.location.reload();\n      }, 1200);\n    });\n  } catch (error) {}\n} // xử lý cập nhật thông tin sản phẩm trong admin\n\n\nasync function handleUpadatePrByAdmin(obj) {\n  Swal.fire({\n    icon: \"success\",\n    text: `Vui lòng đợi...`,\n    timer: 1000,\n    showConfirmButton: false\n  });\n\n  if (typeof obj.image != \"string\") {\n    var newImage = await handleUploadCloudinary(obj.image);\n  }\n\n  const newProduct = { ...obj,\n    image: newImage ? newImage.url : obj.image\n  };\n  axioisClient.post(\"/admin/update-product\", newProduct).then(res => {\n    if (res.err) {\n      Swal.fire({\n        icon: \"error\",\n        text: `${res.mess}`,\n        timer: 1100\n      });\n    } else {\n      Swal.fire({\n        icon: \"success\",\n        text: `${res.mess}`,\n        timer: 1100\n      });\n      setTimeout(() => {\n        window.location.replace(window.location.href);\n      }, 1100);\n    }\n  }).catch(err => {\n    Swal.fire({\n      icon: \"error\",\n      text: `Có lỗi trong quá trình thực hiện`\n    });\n  });\n}\n\nasync function handleUploadCloudinary(file) {\n  const formData = new FormData();\n  formData.append(\"file\", file);\n  formData.append(\"upload_preset\", \"ikplw4ix\");\n  formData.append(\"api_key\", \"355975891631955\");\n  formData.append(\"api_secret\", \"bF31cB70H4CAJ65_6q2RyP5Zjc8\");\n  return axios.post(\"https://api.cloudinary.com/v1_1/dsqs1mruw/image/upload\", formData).then(res => res.data);\n}\n\nexport default {\n  handleClick,\n  handleLogin,\n  handleRegsiter,\n  handle_add_to_cart,\n  handle_get_size_cart,\n  checkLogin,\n  handleDeleteProductFormCart,\n  handlePayment,\n  handleLogout,\n  addProductByAdmin,\n  handleDeleteProduct,\n  handleUpadatePrByAdmin,\n  handleUploadCloudinary\n};","map":{"version":3,"sources":["C:/Users/sonhe/OneDrive/Desktop/New folder/nhom6-csdlnc/client/src/management_state.js"],"names":["axioisClient","axios","Cloudinary","Swal","handleClick","isLoginPage","callback","handleLogin","username","password","role","redirect","Boolean","fire","icon","text","timer","post","then","res","err","mess","localStorage","setItem","account","_id","setTimeout","window","location","assign","console","log","catch","handleRegsiter","confirmPassword","email","phone","address","time","handle_add_to_cart","user_id","product_id","one_pr_price","amount","getItem","status","cart_id","document","querySelector","innerHTML","textContent","handle_get_size_cart","get","size","error","handleDeleteProductFormCart","addProductByAdmin","obj","name","price","origin","classify","desc","image","replaceAll","charAt","length","data","handleUploadCloudinary","url","handleFile","file","handlePayment","listIdCart","cart_list","JSON","stringify","replace","href","checkLogin","isLogin","handleLogout","removeItem","handleDeleteProduct","reload","handleUpadatePrByAdmin","showConfirmButton","newImage","newProduct","formData","FormData","append"],"mappings":"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","sourcesContent":["import axioisClient from \"./axios\";\r\nimport axios from \"axios\";\r\n\r\nimport { Cloudinary } from \"@cloudinary/url-gen\";\r\n\r\nimport Swal from \"sweetalert2/dist/sweetalert2.js\";\r\nimport \"sweetalert2/src/sweetalert2.scss\";\r\n\r\n// Xử lý chuyển qua lại giữa login và register\r\nfunction handleClick(isLoginPage, callback) {\r\n  callback(!isLoginPage);\r\n}\r\n\r\n//Xử lý gửi form đăng nhập\r\nfunction handleLogin(username, password, role = \"USER_ROLE\", redirect = \"/\") {\r\n  if (!Boolean(username) || !Boolean(password)) {\r\n    Swal.fire({\r\n      icon: \"error\",\r\n      text: \"Vui lòng nhập đầy đủ thông tin....\",\r\n      timer: 1200,\r\n    });\r\n  } else {\r\n    axioisClient\r\n      .post(\"login\", {\r\n        username,\r\n        password,\r\n        role,\r\n      })\r\n      .then((res) => {\r\n        if (res.err) {\r\n          Swal.fire({\r\n            icon: \"error\",\r\n            text: res.mess,\r\n            timer: 1200,\r\n          });\r\n        } else {\r\n          Swal.fire({\r\n            icon: \"success\",\r\n            text: \"Đăng nhập thành công...\",\r\n            timer: 1200,\r\n          });\r\n          localStorage.setItem(\"isLogin\", res.account._id);\r\n          localStorage.setItem(\"roleLogin\", res.account.role);\r\n          setTimeout(() => {\r\n            window.location.assign(`${redirect}`);\r\n          }, 1200);\r\n        }\r\n\r\n        console.log(res);\r\n      })\r\n      .catch(() => {\r\n        Swal.fire({\r\n          icon: \"error\",\r\n          text: \"Chưa thể xử lý....\",\r\n          timer: 1200,\r\n        });\r\n      });\r\n  }\r\n}\r\n\r\n//Xử lý gửi form đăng ký\r\nfunction handleRegsiter(\r\n  username,\r\n  password,\r\n  confirmPassword,\r\n  email,\r\n  phone,\r\n  address\r\n) {\r\n  if (\r\n    username === \"\" ||\r\n    password === \"\" ||\r\n    confirmPassword === \"\" ||\r\n    email === \"\" ||\r\n    phone === \"\" ||\r\n    address === \"\"\r\n  ) {\r\n    Swal.fire({\r\n      icon: \"error\",\r\n      text: \"Vui lòng nhập đầy đủ thông tin....\",\r\n      timer: 1000,\r\n    });\r\n  } else if (password !== confirmPassword) {\r\n    Swal.fire({\r\n      icon: \"error\",\r\n      text: \"Xác thực mật khẩu không đúng...\",\r\n      timer: 1000,\r\n    });\r\n  } else {\r\n    axioisClient\r\n      .post(\"register\", {\r\n        username,\r\n        password,\r\n        email,\r\n        phone,\r\n        address,\r\n      })\r\n      .then((res) => {\r\n        if (res.err) {\r\n          Swal.fire({\r\n            icon: \"error\",\r\n            text: \"Tài khoản đã tồn tại...\",\r\n            timer: 1000,\r\n          });\r\n        } else {\r\n          const time = 1200;\r\n          Swal.fire({\r\n            icon: \"success\",\r\n            text: \"Đăng ký thành công...\",\r\n            timer: time,\r\n          });\r\n          setTimeout(() => {\r\n            window.location.assign(\"http://localhost:3000/\");\r\n          }, time);\r\n        }\r\n      })\r\n      .catch(() => {\r\n        Swal.fire({\r\n          icon: \"error\",\r\n          text: \"Dữ liệu tại chưa được xử lý...\",\r\n          timer: 1000,\r\n        });\r\n      });\r\n  }\r\n}\r\n\r\n//xử lý thêm vào giỏ hàng\r\nfunction handle_add_to_cart(user_id, product_id, one_pr_price, amount) {\r\n  if (!Boolean(localStorage.getItem(\"isLogin\"))) {\r\n    Swal.fire({\r\n      icon: \"error\",\r\n      text: \"Vui lòng đăng nhập để tiếp tục....\",\r\n      timer: 1000,\r\n    });\r\n  } else {\r\n    axioisClient\r\n      .post(\"add-to-cart\", {\r\n        user_id,\r\n        product_id,\r\n        one_pr_price,\r\n        amount,\r\n      })\r\n      .then((res) => {\r\n        if (!res.err) {\r\n          const status = res.status;\r\n          const cart_id = document.querySelector(\".cart_id\");\r\n          if (status === 0) {\r\n            cart_id.innerHTML = +cart_id.textContent + 1;\r\n          }\r\n          Swal.fire({\r\n            icon: \"success\",\r\n            text: \"Thêm thàng công....\",\r\n            timer: 1000,\r\n          });\r\n        } else {\r\n        }\r\n        console.log(res);\r\n      });\r\n  }\r\n}\r\n\r\n// lấy ra số lượng đơn hàng trong giỏ hàng\r\nfunction handle_get_size_cart(user_id) {\r\n  axioisClient\r\n    .get(`user/carts/${user_id}`)\r\n    .then((res) => {\r\n      const cart_id = document.querySelector(\".cart_id\");\r\n      cart_id.innerHTML = res.size;\r\n    })\r\n    .catch((error) => {\r\n      console.log(\"Co loix\");\r\n    });\r\n}\r\n\r\n// xử lý xóa đơn hàng khỏi giỏ hàng\r\nfunction handleDeleteProductFormCart(_id) {\r\n  axioisClient\r\n    .post(\"/cart/detete\", { _id })\r\n    .then((res) => {\r\n      console.log(res);\r\n    })\r\n    .catch((err) => {\r\n      console.log(err);\r\n    });\r\n}\r\n\r\n// xử lý thêm sản phẩm ở trang Admin\r\nasync function addProductByAdmin(obj) {\r\n  if (\r\n    !Boolean(obj.name) ||\r\n    !Boolean(obj.price) ||\r\n    !Boolean(obj.amount) ||\r\n    !Boolean(obj.origin) ||\r\n    !Boolean(obj.classify) ||\r\n    !Boolean(obj.desc) ||\r\n    !Boolean(obj.image)\r\n  ) {\r\n    Swal.fire({\r\n      icon: \"error\",\r\n      text: \"Vui lòng nhập đủ thông tin sản phẩm\",\r\n      timer: 1100,\r\n    });\r\n  } else if (\r\n    !Boolean(+obj.price.replaceAll(\".\", \"\")) ||\r\n    obj.price.charAt(obj.price.length - 4) != \".\"\r\n  ) {\r\n    Swal.fire({\r\n      icon: \"error\",\r\n      text: \"Giá tiền không hợp lệ\",\r\n      timer: 1100,\r\n    });\r\n  } else {\r\n    console.log(obj);\r\n    const data = await handleUploadCloudinary(obj.image);\r\n    axioisClient\r\n      .post(\"/add-product\", {\r\n        ...obj,\r\n        image: data.url,\r\n      })\r\n      .then((res) => {\r\n        if (res.err) {\r\n          Swal.fire({\r\n            icon: \"error\",\r\n            text: \"Sản phẩm đã tồn tại...\",\r\n            timer: 1100,\r\n          });\r\n        } else {\r\n          Swal.fire({\r\n            icon: \"success\",\r\n            text: \"Thêm thành công...\",\r\n            timer: 1100,\r\n          });\r\n        }\r\n      })\r\n      .catch((err) => {\r\n        Swal.fire({\r\n          icon: \"error\",\r\n          text: \"Có lỗi trong quá trình xử lý...\",\r\n          timer: 1100,\r\n        });\r\n      });\r\n  }\r\n}\r\n\r\nfunction handleFile(file) {}\r\n\r\n// xử lý thanh toán\r\nfunction handlePayment(listIdCart) {\r\n  axioisClient\r\n    .post(\"/user/payment\", {\r\n      cart_list: JSON.stringify(listIdCart),\r\n    })\r\n    .then((res) => {\r\n      if (res.err) {\r\n        Swal.fire({\r\n          icon: \"error\",\r\n          text: \"Thanh toán không thành công.... \",\r\n          timer: 1100,\r\n        });\r\n      } else {\r\n        Swal.fire({\r\n          icon: \"success\",\r\n          text: \"Thanh toán thành công....\",\r\n          timer: 1100,\r\n        });\r\n\r\n        setTimeout(() => {\r\n          window.location.replace(window.location.href);\r\n        }, 1100);\r\n      }\r\n    })\r\n    .catch((err) => {\r\n      console.log(err);\r\n    });\r\n}\r\n\r\n// kiểm tra đăng nhập\r\nfunction checkLogin() {\r\n  const isLogin = localStorage.getItem(\"isLogin\");\r\n  return Boolean(isLogin);\r\n}\r\n\r\n// xử lý đăng xuất\r\nfunction handleLogout(redirect) {\r\n  localStorage.removeItem(\"isLogin\");\r\n  localStorage.removeItem(\"roleLogin\");\r\n  Swal.fire({\r\n    icon: \"success\",\r\n    text: \"Đăng xuất thành công...\",\r\n    timer: 1000,\r\n  });\r\n\r\n  setTimeout(() => {\r\n    window.location.assign(`http://localhost:3000/${redirect}`);\r\n  }, 1000);\r\n}\r\n\r\n// xử lý xóa sản phẩm trang admin\r\nfunction handleDeleteProduct(_id) {\r\n  try {\r\n    axioisClient.post(\"/admin/delete-product\", { _id }).then((res) => {\r\n      const icon = res.err ? \"error\" : \"success\";\r\n      Swal.fire({\r\n        icon: `${icon}`,\r\n        text: `${res.mess}`,\r\n        timer: 1100,\r\n      });\r\n      setTimeout(() => {\r\n        window.location.reload();\r\n      }, 1200);\r\n    });\r\n  } catch (error) {}\r\n}\r\n\r\n// xử lý cập nhật thông tin sản phẩm trong admin\r\nasync function handleUpadatePrByAdmin(obj) {\r\n  Swal.fire({\r\n    icon: \"success\",\r\n    text: `Vui lòng đợi...`,\r\n    timer: 1000,\r\n    showConfirmButton: false,\r\n  });\r\n\r\n  if (typeof obj.image != \"string\") {\r\n    var newImage = await handleUploadCloudinary(obj.image);\r\n  }\r\n  const newProduct = {\r\n    ...obj,\r\n    image: newImage ? newImage.url : obj.image,\r\n  };\r\n\r\n  axioisClient\r\n    .post(\"/admin/update-product\", newProduct)\r\n    .then((res) => {\r\n      if (res.err) {\r\n        Swal.fire({\r\n          icon: \"error\",\r\n          text: `${res.mess}`,\r\n          timer: 1100,\r\n        });\r\n      } else {\r\n        Swal.fire({\r\n          icon: \"success\",\r\n          text: `${res.mess}`,\r\n          timer: 1100,\r\n        });\r\n\r\n        setTimeout(() => {\r\n          window.location.replace(window.location.href);\r\n        }, 1100);\r\n      }\r\n    })\r\n    .catch((err) => {\r\n      Swal.fire({\r\n        icon: \"error\",\r\n        text: `Có lỗi trong quá trình thực hiện`,\r\n      });\r\n    });\r\n}\r\n\r\nasync function handleUploadCloudinary(file) {\r\n  const formData = new FormData();\r\n  formData.append(\"file\", file);\r\n  formData.append(\"upload_preset\", \"ikplw4ix\");\r\n  formData.append(\"api_key\", \"355975891631955\");\r\n  formData.append(\"api_secret\", \"bF31cB70H4CAJ65_6q2RyP5Zjc8\");\r\n  return axios\r\n    .post(\"https://api.cloudinary.com/v1_1/dsqs1mruw/image/upload\", formData)\r\n    .then((res) => res.data);\r\n}\r\n\r\nexport default {\r\n  handleClick,\r\n  handleLogin,\r\n  handleRegsiter,\r\n  handle_add_to_cart,\r\n  handle_get_size_cart,\r\n  checkLogin,\r\n  handleDeleteProductFormCart,\r\n  handlePayment,\r\n  handleLogout,\r\n  addProductByAdmin,\r\n  handleDeleteProduct,\r\n  handleUpadatePrByAdmin,\r\n  handleUploadCloudinary,\r\n};\r\n"]},"metadata":{},"sourceType":"module"}