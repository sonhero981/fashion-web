{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\sonhe\\\\OneDrive\\\\Desktop\\\\New folder\\\\nhom6-csdlnc\\\\client\\\\src\\\\Cart\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useContext, useLayoutEffect, useRef } from \"react\";\nimport \"./css/index.scss\";\nimport { HandleContext } from \"../index\";\nimport axioisClient from \"../axios\";\nimport empty_cart from \"./empty-cart.png\";\nimport Swal from \"sweetalert2/dist/sweetalert2.js\";\nimport \"sweetalert2/src/sweetalert2.scss\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function Cart_Page() {\n  _s();\n\n  const [totalPayment, setTotalPayemt] = useState(0);\n  const [str_TotalPayment, setStrTtPayment] = useState(\"0\"); // lưu danh sách thông tin các sản phẩm trong giỏ\n\n  const [listPayment, setListPayment] = useState([]); // lưu danh sách id nhưng sản phẩm đã thêm vào giỏ\n\n  const [listIdCart, setListIdCart] = useState([]); // lưu danh sách những sản phẩm cần thanh toán\n\n  const [listIdPayment, setListIdPayment] = useState([]);\n  const {\n    checkLogin,\n    handleDeleteProductFormCart,\n    handlePayment,\n    handle_get_size_cart\n  } = useContext(HandleContext);\n\n  const handleSums = money => {\n    const new_money = totalPayment + money;\n    let String_Money = \"\";\n    let String_Money_temp = \"\";\n    const temp = \"\" + new_money;\n    let count = 0;\n\n    for (let index = temp.length; index >= 0; index--) {\n      String_Money += temp.charAt(index);\n\n      if (count === 3) {\n        String_Money += \".\";\n        count = 0;\n      }\n\n      count++;\n    }\n\n    for (let index = String_Money.length; index >= 0; index--) {\n      String_Money_temp += String_Money.charAt(index);\n    }\n\n    setTotalPayemt(new_money);\n    setStrTtPayment(String_Money_temp);\n  };\n\n  useLayoutEffect(() => {\n    if (!checkLogin()) {\n      window.location.replace(\"http://localhost:3000\");\n    } else {\n      axioisClient.get(`user/carts/${localStorage.getItem(\"isLogin\")}`).then(res => {\n        setListIdCart(res.data);\n        const lists = res.data.map(item => {\n          return axioisClient.get(`/product-by-id/${item.product_id}`);\n        });\n        Promise.all(lists).then(data => {\n          setListPayment(data);\n        });\n      }).catch(err => {\n        console.log(\"Co loi phat sinh\");\n      });\n    }\n  }, []);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: checkLogin() ? /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"cart_container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"cart_header\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cart_header--item c_1\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"S\\u1EA3n ph\\u1EA9m\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cart_header--item c_3\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Gi\\xE1 \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cart_header--item c_2\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"S\\u1ED1 l\\u01B0\\u1EE3ng\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cart_header--item c_3\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"T\\u1ED5ng ti\\u1EC1n\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cart_header--item c_2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"cart_content\",\n        style: listPayment.length === 0 ? {\n          backgroundImage: `url('${empty_cart}')`,\n          backgroundPosition: \"center\",\n          backgroundRepeat: \"no-repeat\"\n        } : {},\n        children: listPayment.map((item, index) => {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cart_content--item\",\n            id: listIdCart[index]._id,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"c_1 cart--temp-cart\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"cart_check-payment\",\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"checkbox\",\n                  name: \"\",\n                  id: \"\",\n                  checked: listIdPayment.includes(listIdCart[index]._id),\n                  onChange: () => {\n                    setListIdPayment(prev => {\n                      if (listIdPayment.includes(listIdCart[index]._id)) {\n                        handleSums(-listIdCart[index].sum_price.replaceAll(\".\", \"\"));\n                        return listIdPayment.filter(item => item !== listIdCart[index]._id);\n                      } else {\n                        handleSums(+listIdCart[index].sum_price.replaceAll(\".\", \"\"));\n                        return [...prev, listIdCart[index]._id];\n                      }\n                    });\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 117,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 116,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                id: \"cart_img\",\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: item.data.image,\n                  alt: \"\",\n                  style: {\n                    display: \"block\",\n                    width: \"100%\"\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 143,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 142,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: item.data.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 149,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"c_3 cart--temp-cart\",\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                children: [item.data.price, \"\\u0111 \"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 152,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 151,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"c_2 cart--temp-cart\",\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                children: listIdCart[index].amount\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 155,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"c_3 cart--temp-cart\",\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                children: [listIdCart[index].sum_price, \"\\u0111\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 158,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 157,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"c_2 cart--temp-cart\",\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cart_delete--btn\",\n                onClick: e => {\n                  handleDeleteProductFormCart(listIdCart[index]._id);\n                  handle_get_size_cart(localStorage.getItem(\"isLogin\"));\n                  setListPayment(prev => prev.filter((item, indexx) => indexx != index));\n                  setListIdCart(prev => prev.filter((item, indexx) => indexx != index));\n                },\n                children: /*#__PURE__*/_jsxDEV(\"ion-icon\", {\n                  name: \"trash\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 174,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 161,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 160,\n              columnNumber: 19\n            }, this)]\n          }, listIdCart[index]._id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 17\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"cart_payment\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"cart_total\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [\"T\\u1ED5ng ti\\u1EC1n: \", str_TotalPayment, \"\\u0111\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"cart_payment-btn\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            onClick: () => {\n              if (listIdPayment.length === 0) {\n                Swal.fire({\n                  icon: \"error\",\n                  text: \"Vui lòng chọn sản phẩm để thanh toán....\",\n                  timer: 1000\n                });\n              } else {\n                handlePayment(listIdPayment);\n              }\n            },\n            children: \"Thanh To\\xE1n\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"h1\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n}\n\n_s(Cart_Page, \"t95Qxek5J+CXUuo5EiQpNTS/Xjg=\");\n\n_c = Cart_Page;\n\nvar _c;\n\n$RefreshReg$(_c, \"Cart_Page\");","map":{"version":3,"sources":["C:/Users/sonhe/OneDrive/Desktop/New folder/nhom6-csdlnc/client/src/Cart/index.js"],"names":["useState","useContext","useLayoutEffect","useRef","HandleContext","axioisClient","empty_cart","Swal","Cart_Page","totalPayment","setTotalPayemt","str_TotalPayment","setStrTtPayment","listPayment","setListPayment","listIdCart","setListIdCart","listIdPayment","setListIdPayment","checkLogin","handleDeleteProductFormCart","handlePayment","handle_get_size_cart","handleSums","money","new_money","String_Money","String_Money_temp","temp","count","index","length","charAt","window","location","replace","get","localStorage","getItem","then","res","data","lists","map","item","product_id","Promise","all","catch","err","console","log","backgroundImage","backgroundPosition","backgroundRepeat","_id","includes","prev","sum_price","replaceAll","filter","image","display","width","name","price","amount","e","indexx","fire","icon","text","timer"],"mappings":"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","sourcesContent":["import { useState, useContext, useLayoutEffect, useRef } from \"react\";\r\n\r\nimport \"./css/index.scss\";\r\n\r\nimport { HandleContext } from \"../index\";\r\nimport axioisClient from \"../axios\";\r\n\r\nimport empty_cart from \"./empty-cart.png\";\r\n\r\nimport Swal from \"sweetalert2/dist/sweetalert2.js\";\r\nimport \"sweetalert2/src/sweetalert2.scss\";\r\n\r\nexport default function Cart_Page() {\r\n  const [totalPayment, setTotalPayemt] = useState(0);\r\n  const [str_TotalPayment, setStrTtPayment] = useState(\"0\");\r\n\r\n  // lưu danh sách thông tin các sản phẩm trong giỏ\r\n  const [listPayment, setListPayment] = useState([]);\r\n\r\n  // lưu danh sách id nhưng sản phẩm đã thêm vào giỏ\r\n  const [listIdCart, setListIdCart] = useState([]);\r\n\r\n  // lưu danh sách những sản phẩm cần thanh toán\r\n  const [listIdPayment, setListIdPayment] = useState([]);\r\n\r\n  const {\r\n    checkLogin,\r\n    handleDeleteProductFormCart,\r\n    handlePayment,\r\n    handle_get_size_cart,\r\n  } = useContext(HandleContext);\r\n\r\n  const handleSums = (money) => {\r\n    const new_money = totalPayment + money;\r\n\r\n    let String_Money = \"\";\r\n    let String_Money_temp = \"\";\r\n    const temp = \"\" + new_money;\r\n\r\n    let count = 0;\r\n    for (let index = temp.length; index >= 0; index--) {\r\n      String_Money += temp.charAt(index);\r\n      if (count === 3) {\r\n        String_Money += \".\";\r\n        count = 0;\r\n      }\r\n      count++;\r\n    }\r\n    for (let index = String_Money.length; index >= 0; index--) {\r\n      String_Money_temp += String_Money.charAt(index);\r\n    }\r\n\r\n    setTotalPayemt(new_money);\r\n    setStrTtPayment(String_Money_temp);\r\n  };\r\n  useLayoutEffect(() => {\r\n    if (!checkLogin()) {\r\n      window.location.replace(\"http://localhost:3000\");\r\n    } else {\r\n      axioisClient\r\n        .get(`user/carts/${localStorage.getItem(\"isLogin\")}`)\r\n        .then((res) => {\r\n          setListIdCart(res.data);\r\n          const lists = res.data.map((item) => {\r\n            return axioisClient.get(`/product-by-id/${item.product_id}`);\r\n          });\r\n          Promise.all(lists).then((data) => {\r\n            setListPayment(data);\r\n          });\r\n        })\r\n        .catch((err) => {\r\n          console.log(\"Co loi phat sinh\");\r\n        });\r\n    }\r\n  }, []);\r\n\r\n  return (\r\n    <>\r\n      {checkLogin() ? (\r\n        <div id=\"cart_container\">\r\n          <div id=\"cart_header\">\r\n            <div className=\"cart_header--item c_1\">\r\n              <span>Sản phẩm</span>\r\n            </div>\r\n            <div className=\"cart_header--item c_3\">\r\n              <span>Giá </span>\r\n            </div>\r\n            <div className=\"cart_header--item c_2\">\r\n              <span>Số lượng</span>\r\n            </div>\r\n            <div className=\"cart_header--item c_3\">\r\n              <span>Tổng tiền</span>\r\n            </div>\r\n            <div className=\"cart_header--item c_2\"></div>\r\n          </div>\r\n          <div\r\n            id=\"cart_content\"\r\n            style={\r\n              listPayment.length === 0\r\n                ? {\r\n                    backgroundImage: `url('${empty_cart}')`,\r\n                    backgroundPosition: \"center\",\r\n                    backgroundRepeat: \"no-repeat\",\r\n                  }\r\n                : {}\r\n            }\r\n          >\r\n            {listPayment.map((item, index) => {\r\n              return (\r\n                <div\r\n                  className=\"cart_content--item\"\r\n                  key={listIdCart[index]._id}\r\n                  id={listIdCart[index]._id}\r\n                >\r\n                  <div className=\"c_1 cart--temp-cart\">\r\n                    <div className=\"cart_check-payment\">\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        name=\"\"\r\n                        id=\"\"\r\n                        checked={listIdPayment.includes(listIdCart[index]._id)}\r\n                        onChange={() => {\r\n                          setListIdPayment((prev) => {\r\n                            if (listIdPayment.includes(listIdCart[index]._id)) {\r\n                              handleSums(\r\n                                -listIdCart[index].sum_price.replaceAll(\".\", \"\")\r\n                              );\r\n                              return listIdPayment.filter(\r\n                                (item) => item !== listIdCart[index]._id\r\n                              );\r\n                            } else {\r\n                              handleSums(\r\n                                +listIdCart[index].sum_price.replaceAll(\".\", \"\")\r\n                              );\r\n                              return [...prev, listIdCart[index]._id];\r\n                            }\r\n                          });\r\n                        }}\r\n                      />\r\n                    </div>\r\n\r\n                    <div id=\"cart_img\">\r\n                      <img\r\n                        src={item.data.image}\r\n                        alt=\"\"\r\n                        style={{ display: \"block\", width: \"100%\" }}\r\n                      />\r\n                    </div>\r\n                    <span>{item.data.name}</span>\r\n                  </div>\r\n                  <div className=\"c_3 cart--temp-cart\">\r\n                    <span>{item.data.price}đ </span>\r\n                  </div>\r\n                  <div className=\"c_2 cart--temp-cart\">\r\n                    <span>{listIdCart[index].amount}</span>\r\n                  </div>\r\n                  <div className=\"c_3 cart--temp-cart\">\r\n                    <span>{listIdCart[index].sum_price}đ</span>\r\n                  </div>\r\n                  <div className=\"c_2 cart--temp-cart\">\r\n                    <span\r\n                      className=\"cart_delete--btn\"\r\n                      onClick={(e) => {\r\n                        handleDeleteProductFormCart(listIdCart[index]._id);\r\n                        handle_get_size_cart(localStorage.getItem(\"isLogin\"));\r\n                        setListPayment((prev) =>\r\n                          prev.filter((item, indexx) => indexx != index)\r\n                        );\r\n                        setListIdCart((prev) =>\r\n                          prev.filter((item, indexx) => indexx != index)\r\n                        );\r\n                      }}\r\n                    >\r\n                      <ion-icon name=\"trash\"></ion-icon>\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n          <div id=\"cart_payment\">\r\n            <div id=\"cart_total\">\r\n              <span>Tổng tiền: {str_TotalPayment}đ</span>\r\n            </div>\r\n            <div id=\"cart_payment-btn\">\r\n              <span\r\n                onClick={() => {\r\n                  if (listIdPayment.length === 0) {\r\n                    Swal.fire({\r\n                      icon: \"error\",\r\n                      text: \"Vui lòng chọn sản phẩm để thanh toán....\",\r\n                      timer: 1000,\r\n                    });\r\n                  } else {\r\n                    handlePayment(listIdPayment);\r\n                  }\r\n                }}\r\n              >\r\n                Thanh Toán\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        <h1></h1>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}